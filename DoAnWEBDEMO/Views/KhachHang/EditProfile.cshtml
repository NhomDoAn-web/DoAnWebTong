@model DoAnWEBDEMO.Models.KhachHang
@{
    ViewData["Title"] = "EditProfile";
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
}
@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success">@TempData["SuccessMessage"]</div>
}


@section CSS
{
    <link rel="stylesheet" href="~/css/profile.css" asp-append-version="true" />
}
<div class="container mt-5">

    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3">
            @Html.Partial("~/Views/Shared/PartialsViews/_SlidebarProfile.cshtml")
        </div>

        <div class="col-md-9">
            <h2>Chỉnh sửa thông tin tài khoản</h2>

            <form id="editProfileForm" method="post" asp-controller="KhachHang" asp-action="EditProfile">


                <div class="form-group">
                    <label for="hoKH">Họ</label>
                    <input type="text" class="form-control" id="hoKH" name="hoKH" value="@Model.HoKH" required />
                </div>


                <div class="form-group">
                    <label for="tenKH">Tên</label>
                    <input type="text" class="form-control" id="tenKH" name="tenKH" value="@Model.TenKH" required />
                </div>


                <div class="form-group">
                    <label for="gioiTinh">Giới Tính</label>
                    <select class="form-control" id="gioiTinh" name="gioiTinh">
                        @if (Model.GioiTinh == "Nam")
                        {
                            <option value="Nam" selected>Nam</option>
                            <option value="Nữ">Nữ</option>
                        }
                        else
                        {
                            <option value="Nam">Nam</option>
                            <option value="Nữ" selected>Nữ</option>
                        }
                    </select>
                </div>

                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" class="form-control" id="email" name="email" value="@Model.Email" required />
                </div>


                <div class="form-group">
                    <label for="sdt">Số điện thoại</label>
                    <input type="text" class="form-control" id="sdt" name="sdt" value="@Model.SDT" required />
                </div>


                <div class="form-group">
                    <label for="diaChi">Địa chỉ</label>
                    <input type="text" class="form-control" id="diaChi" name="diaChi" value="@Model.DiaChi" required />
                </div>

                <button type="submit" class="btn btn-primary mt-3">Cập nhật</button>
            </form>
        </div>
    </div>
</div>




<script>
    $(document).ready(function () {
        $('#editProfileForm').submit(function (e) {
            e.preventDefault();

            const data = $(this).serialize(); // Lấy dữ liệu từ form
            $.ajax({
                url: '/KhachHang/EditProfile',
                type: 'POST',
                data: data,
                success: function (response) {
                    if (response.success) { // Thành công
                        alert(response.message);
                        window.location.href = '/KhachHang/Profile';
                    } else { // Thất bại
                        alert('Cập nhật thất bại: ' + response.message);
                    }
                },
                error: function (err) {
                    console.error(err);
                    alert('Có lỗi xảy ra, vui lòng thử lại.');
                }
            });
        });
    });

</script>


